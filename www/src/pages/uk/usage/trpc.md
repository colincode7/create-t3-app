---
title: tRPC
description: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è tRPC
layout: ../../../layouts/docs.astro
lang: uk
---

tRPC –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –ø–∏—Å–∞—Ç–∏ —Ç–∏–ø–æ–±–µ–∑–ø–µ—á–Ω—ñ API –≤—ñ–¥ –∫—ñ–Ω—Ü—è –¥–æ –∫—ñ–Ω—Ü—è (end-to-end) –±–µ–∑ –±—É–¥—å-—è–∫–æ—ó –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–æ–¥—É —á–∏ –ø–æ–¥–æ–≤–∂–µ–Ω–Ω—è —Ä–∞–Ω—Ç–∞–π–º—É. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —á—É–¥–æ–≤–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫ TypeScript –¥–ª—è –≤–∏–≤–µ–¥–µ–Ω–Ω—è –≤–∏–∑–Ω–∞—á–µ–Ω—å —Ç–∏–ø—ñ–≤ –≤–∞—à–æ–≥–æ API-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ —ñ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤–∞—à—ñ API-–ø—Ä–æ—Ü–µ–¥—É—Ä–∏ –∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∑ –ø–æ–≤–Ω–æ—é –±–µ–∑–ø–µ–∫–æ—é —Ç–∏–ø—ñ–≤ —ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è–º. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ tRPC, –≤–∞—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —ñ –±–µ–∫–µ–Ω–¥ –ø–æ—á—É–≤–∞—é—Ç—å—Å—è –±–ª–∏–∂—á–µ –æ–¥–∏–Ω –¥–æ –æ–¥–Ω–æ–≥–æ, –Ω—ñ–∂ –±—É–¥—å-–∫–æ–ª–∏, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –≤–∏–Ω—è—Ç–∫–æ–≤–∏–π –¥–æ—Å–≤—ñ–¥ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞.

<blockquote className="w-full relative border-l-4 italic bg-t3-purple-200 dark:text-t3-purple-50 text-zinc-900 dark:bg-t3-purple-300/20 p-2 rounded-md text-sm my-3 border-neutral-500 quote">
  <div className="relative w-fit flex items-center justify-center p-1">
    <p className="mb-4 text-lg">
      <span aria-hidden="true">&quot;</span>I built tRPC to allow people to move faster by removing the need of a traditional API-layer, while still having confidence that our apps won't break as we rapidly iterate.<span aria-hidden="true">&quot;</span>
    </p>
  </div>
  <cite className="flex items-center justify-end pr-4 pb-2">
    <img
      alt="Avatar of @alexdotjs"
      className="w-12 rounded-full bg-neutral-500 [margin-inline-end:16px]"
      src="https://avatars.githubusercontent.com/u/459267?v=4"
    />
    <div className="flex flex-col items-start not-italic">
      <span className=" text-sm font-semibold">Alex - creator of tRPC</span>
      <a
        href="https://twitter.com/alexdotjs"
        target="_blank"
        rel="noopener noreferrer"
        className="text-sm"
      >
        @alexdotjs
      </a>
    </div>
  </cite>
</blockquote>

## –Ø–∫ —è –º–æ–∂—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ tRPC?

<div class="embed">
<iframe width="560" height="315" src="https://www.youtube.com/embed/2LYM8gf184U" title="Making typesafe APIs easy with tRPC" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

tRPC –∫–æ–Ω—Ç—Ä–∏–±'—é—Ç–æ—Ä [trashh_dev](https://twitter.com/trashh_dev) [–≤–∏—Å—Ç—É–ø–∏–≤ –Ω–∞ Next.js Conf](https://www.youtube.com/watch?v=2LYM8gf184U) –∑ —Ä–æ–∑–ø–æ–≤—ñ–¥–¥—é –ø—Ä–æ tRPC. –ú–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –≤–∞–º –ø–æ–¥–∏–≤–∏—Ç–∏—Å—è, —è–∫—â–æ –≤–∏ —â–µ –Ω–µ –∑—Ä–æ–±–∏–ª–∏ —Ü–µ.

–ó tRPC –≤–∏ –ø–∏—à–µ—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—ó TypeScript –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—î—Ç–µ —ó—Ö —ñ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É. –ü—Ä–æ—Å—Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ tRPC –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ —Ç–∞–∫:

```ts:server/api/routers/user.ts
const userRouter = createTRPCRouter({
  getById: publicProcedure.input(z.string()).query(({ ctx, input }) => {
    return ctx.prisma.user.findFirst({
      where: {
        id: input,
      },
    });
  }),
});
```

–¶–µ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ tRPC (–µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç route handler-–∞ —É —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ–º—É –±–µ–∫–µ–Ω–¥—ñ), —è–∫–∞ —Å–ø–æ—á–∞—Ç–∫—É –ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Zod (—è–∫–∏–π —î —Ç—ñ—î—é —Å–∞–º–æ—é –±—ñ–±–ª—ñ–æ—Ç–µ–∫–æ—é –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —è–∫—É –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –¥–ª—è [–∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞](./env-variables)) ‚Äì —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –ø–µ—Ä–µ–∫–æ–Ω—É—î–º–æ—Å—å , —â–æ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —î —Ä—è–¥–∫–æ–º. –Ø–∫—â–æ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –Ω–µ —î —Ä—è–¥–∫–æ–º, –≤—ñ–Ω –Ω–∞–¥—ñ—à–ª–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—É –ø–æ–º–∏–ª–∫—É.

–ü—ñ—Å–ª—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –º–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –∞–±–æ [–∑–∞–ø–∏—Ç–æ–º](https://trpc.io/docs/v10/react-queries), [–º—É—Ç–∞—Ü—ñ—î—é](https://trpc.io/docs/v10/react-mutations) –∞–±–æ [–ø—ñ–¥–ø–∏—Å–∫–æ—é](https://trpc.io/docs/v10/subscriptions). –£ –Ω–∞—à–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ resolver –≤–∏–∫–ª–∏–∫–∞—î –Ω–∞—à—É –±–∞–∑—É –¥–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª—ñ—î–Ω—Ç–∞ [prisma](./prisma) —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —É —è–∫–æ–≥–æ `id` –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ —Ç–∏–º, —â–æ –º–∏ –ø–µ—Ä–µ–¥–∞–ª–∏.

–í–∏ –≤–∏–∑–Ω–∞—á–∞—î—Ç–µ —Å–≤–æ—ó –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ –≤ `routers` —è–∫—ñ —î –∫–æ–ª–µ–∫—Ü—ñ—î—é –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä —ñ–∑ —Å–ø—ñ–ª—å–Ω–∏–º —ñ–º'—è–º. –£ –≤–∞—Å –º–æ–∂–µ –±—É—Ç–∏ –æ–¥–∏–Ω —Ä–æ—É—Ç–µ—Ä –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –æ–¥–∏–Ω –¥–ª—è –ø–æ—Å—Ç—ñ–≤ —ñ —â–µ –æ–¥–∏–Ω –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å. –¶—ñ —Ä–æ—É—Ç–µ—Ä–∏ –ø–æ—Ç—ñ–º –º–æ–∂–Ω–∞ –æ–±'—î–¥–Ω–∞—Ç–∏ –≤ —î–¥–∏–Ω–∏–π —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π `appRouter`:

```ts:server/api/root.ts
const appRouter = createTRPCRouter({
  users: userRouter,
  posts: postRouter,
  messages: messageRouter,
});

export type AppRouter = typeof appRouter;
```

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ —Ç–∏–ø–∏ –Ω–∞—à–∏—Ö —Ä–æ—É—Ç–µ—Ä—ñ–≤, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–∏ –Ω—ñ–∫–æ–ª–∏ –Ω–µ —ñ–º–ø–æ—Ä—Ç—É—î–º–æ —Å–µ—Ä–≤–µ—Ä–Ω–∏–π –∫–æ–¥ –Ω–∞ –∫–ª—ñ—î–Ω—Ç–∞.

–¢–µ–ø–µ—Ä –¥–∞–≤–∞–π—Ç–µ –≤–∏–∫–ª–∏—á–µ–º–æ –ø—Ä–æ—Ü–µ–¥—É—Ä—É –Ω–∞ –Ω–∞—à–æ–º—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ. tRPC –Ω–∞–¥–∞—î –æ–±–≥–æ—Ä—Ç–∫—É –¥–ª—è `@tanstack/react-query`, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—Å—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Ö—É–∫—ñ–≤ (hooks), —è–∫—ñ –≤—ñ–Ω –Ω–∞–¥–∞—î, –∞–ª–µ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—é –ø–µ—Ä–µ–≤–∞–≥–æ—é —Ç–æ–≥–æ, —â–æ –≤–∞—à—ñ –≤–∏–∫–ª–∏–∫–∏ API —Ç–∏–ø—ñ–∑–æ–≤–∞–Ω—ñ —Ç–∞ —ñ–Ω—Ñ–µ—Ä–æ–≤–∞–Ω—ñ (inferred). –ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –Ω–∞—à—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ –∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É —Ç–∞–∫:

```tsx:pages/users/[id].tsx
import { useRouter } from "next/router";
import { api } from "../../utils/api";

const UserPage = () => {
  const { query } = useRouter();
  const userQuery = api.users.getById.useQuery(query.id);

  return (
    <div>
      <h1>{userQuery.data?.name}</h1>
    </div>
  );
};
```

–í–∏ –≤—ñ–¥—Ä–∞–∑—É –ø–æ–º—ñ—Ç–∏—Ç–µ, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ö–æ—Ä–æ—à—ñ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è —Ç–∞ —Ç–∏–ø–æ–±–µ–∑–ø–µ–∫–∞. –Ø–∫ —Ç—ñ–ª—å–∫–∏ –≤–∏ –ø–æ—á–Ω–µ—Ç–µ –ø–∏—Å–∞—Ç–∏ `api.`, –≤–∞—à—ñ —Ä–æ—É—Ç–µ—Ä–∏ –∑'—è–≤–ª—è—Ç—å—Å—è –≤ –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—ñ, —ñ –∫–æ–ª–∏ –≤–∏ –æ–±–µ—Ä–µ—Ç–µ —Ä–æ—É—Ç–µ—Ä, –π–æ–≥–æ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ —Ç–∞–∫–æ–∂ –∑'—è–≤–ª—è—Ç—å—Å—è. –í–∏ —Ç–∞–∫–æ–∂ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –ø–æ–º–∏–ª–∫—É TypeScript, —è–∫—â–æ –≤–∞—à–µ –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∞–ª—ñ–¥–∞—Ç–æ—Ä—É, —è–∫–∏–π –≤–∏ –≤–∏–∑–Ω–∞—á–∏–ª–∏ –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ.

## –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫

–ü–æ –¥–µ—Ñ–æ–ª—Ç—É, `create-t3-app` —Å—Ç–≤–æ—Ä—é—î [error formatter](https://trpc.io/docs/error-formatting) —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –≤–∏–≤–æ–¥–∏—Ç–∏ –≤–∞—à—ñ Zod –ø–æ–º–∏–ª–∫–∏ —è–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –ø–æ–º–∏–ª–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ.

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:

```tsx
function MyComponent() {
  const { mutate, error } = api.post.create.useMutation();

  return (
    <form onSubmit={(e) => {
      e.preventDefault();
      const formData = new FormData(e.currentTarget);
      mutate({ title: formData.get('title') });
    }}>
      <input name="title" />
      {error?.data?.zodError?.fieldErrors.title && (
        {/** `mutate` returned with an error on the `title` */}
        <span className="mb-8 text-red-500">
          {error.data.zodError.fieldErrors.title}
        </span>
      )}

      ...
    </form>
  );
}
```

## –§–∞–π–ª–∏

tRPC –≤–∏–º–∞–≥–∞—î –±–∞–≥–∞—Ç–æ —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∫–æ–¥—É, —è–∫–∏–π `create-t3-app` –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –¥–ª—è –≤–∞—Å. –î–∞–≤–∞–π—Ç–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ —Ñ–∞–π–ª–∏, —â–æ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è:

### üìÑ `pages/api/trpc/[trpc].ts`

–¶–µ–π —Ñ–∞–π–ª —î —Ç–æ—á–∫–æ—é –≤—Ö–æ–¥—É –¥–ª—è –≤–∞—à–æ–≥–æ API —Ç–∞ –µ–∫—Å–ø–æ—Ä—Ç—É—î –≤–∞—à tRPC —Ä–æ—É—Ç–µ—Ä. –ó–∞–∑–≤–∏—á–∞–π, –≤–∞–º –Ω–µ –¥–æ–≤–µ–¥–µ—Ç—å—Å—è —á—ñ–ø–∞—Ç–∏ —Ü–µ–π —Ñ–∞–π–ª, –∞–ª–µ —è–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∫–ª—é—á–∏—Ç–∏ CORS middleware –∞–±–æ —â–æ—Å—å –ø–æ–¥—ñ–±–Ω–µ, –∫–æ—Ä–∏—Å–Ω–æ –∑–Ω–∞—Ç–∏, —â–æ –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–∏–π `createNextApiHandler` - —Ü–µ [Next.js API handler](https://nextjs.org/docs/api-routes/introduction) —è–∫–∏–π –ø—Ä–∏–π–º–∞—î [request](https://developer.mozilla.org/en-US/docs/Web/API/Request) —Ç–∞ [response](https://developer.mozilla.org/en-US/docs/Web/API/Response) –æ–±'—î–∫—Ç. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –æ–±–µ—Ä–Ω—É—Ç–∏ `createNextApiHandler` —É –±—É–¥—å-—è–∫–∏–π middleware, —è–∫–∏–π –≤–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω. –î–∏–≤–∏—Å—å –Ω–∏–∂—á–µ –¥–ª—è [–ø—Ä–∏–∫–ª–∞–¥—É](#enabling-cors) –¥–æ–¥–∞–≤–∞–Ω–Ω—è CORS.

### üìÑ `server/api/trpc.ts`

–¶–µ–π —Ñ–∞–π–ª –ø–æ–¥—ñ–ª–µ–Ω–æ –Ω–∞ –¥–≤—ñ —á–∞—Å—Ç–∏–Ω–∏: —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è tRPC.

1. –ú–∏ –≤–∏–∑–Ω–∞—á–∞—î–º–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç, —è–∫–∏–π –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –≤–∞—à–∏–º tRPC –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º. –ö–æ–Ω—Ç–µ–∫—Å—Ç - —Ü–µ –¥–∞–Ω—ñ, –¥–æ —è–∫–∏—Ö —É –≤–∞—Å —î –¥–æ—Å—Ç—É–ø —É –≤—Å—ñ—Ö –≤–∞—à–∏—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö tRPC, —ñ —Ü–µ –≤—ñ–¥–º—ñ–Ω–Ω–µ –º—ñ—Å—Ü–µ, —â–æ–± –ø–æ–º—ñ—Å—Ç–∏—Ç–∏ —Ä–µ—á—ñ, —Ç–∞–∫—ñ —è–∫ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö, —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é —ñ —Ç.–¥. –£ create-t3-app –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –¥–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, —â–æ–± —É–≤—ñ–º–∫–Ω—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—ñ–¥–º–Ω–æ–∂–∏–Ω–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, –∫–æ–ª–∏ –º–∏ –Ω–µ –º–∞—î–º–æ –¥–æ—Å—Ç—É–ø—É –¥–æ –æ–±'—î–∫—Ç–∞ –∑–∞–ø–∏—Ç—É.

- `createInnerTRPCContext`: –¶–µ —Ç–µ –º—ñ—Å—Ü–µ, –¥–µ –≤–∏ –≤–∏–∑–Ω–∞—á–∞—î—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç, —è–∫–∏–π –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –∑–∞–ø–∏—Ç—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∞—à–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è [—ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è](#sample-integration-test) –∞–±–æ [ssg-–ø–æ–º—ñ—á–Ω–∏–∫—ñ–≤](https://trpc.io/docs/v10/ssg-helpers), –¥–µ —É –≤–∞—Å –Ω–µ–º–∞—î –æ–±'—î–∫—Ç–∞ –∑–∞–ø–∏—Ç—É.

- `createTRPCContext`: –¢—É—Ç –≤–∏ –≤–∏–∑–Ω–∞—á–∞—î—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç, —è–∫–∏–π –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –∑–∞–ø–∏—Ç—É: –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–µ—Å—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –í–∏ –∑–∞–ø–∏—Ç—É—î—Ç–µ —Å–µ—Å—ñ—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–±'—î–∫—Ç–∞ `opts.req`, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–¥–∞—î—Ç–µ —Å–µ—Å—ñ—é —É —Ñ—É–Ω–∫—Ü—ñ—é `createInnerTRPCContext` –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.

2. –ú–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ tRPC —ñ –≤–∏–∑–Ω–∞—á–∞—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤–∞–Ω—ñ [–ø—Ä–æ—Ü–µ–¥—É—Ä–∏](https://trpc.io/docs/v10/procedures) —Ç–∞ [–ø–æ—Å–µ—Ä–µ–¥–Ω–∏–∫–∏](https://trpc.io/docs/v10/middlewares). –ó–∞ —É–≥–æ–¥–æ—é, –≤–∏ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤–µ—Å—å –æ–±'—î–∫—Ç `t`, –∞ –Ω–∞—Ç–æ–º—ñ—Å—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ —Ç–∞ –ø–æ—Å–µ—Ä–µ–¥–Ω–∏–∫–∏ —Ç–∞ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —ó—Ö.

–í–∏ –ø–æ–º—ñ—Ç–∏—Ç–µ, —â–æ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `superjson` —è–∫ [–ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—á –¥–∞–Ω–∏—Ö](https://trpc.io/docs/v10/data-transformers). –¶–µ –¥–æ–∑–≤–æ–ª—è—î –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Ç–∏–ø–∏ –¥–∞–Ω–∏—Ö, –∫–æ–ª–∏ –≤–æ–Ω–∏ –¥–æ—Å—è–≥–∞—é—Ç—å –∫–ª—ñ—î–Ω—Ç–∞, —Ç–æ–º—É —è–∫—â–æ –≤–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç–µ –æ–±'—î–∫—Ç `Date`, –∫–ª—ñ—î–Ω—Ç –ø–æ–≤–µ—Ä–Ω–µ `Date`, –∞ –Ω–µ —Ä—è–¥–æ–∫, —â–æ —î –Ω–∞–≥–æ–¥–æ—é –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ API.

### üìÑ `server/api/routers/*.ts`

–¶–µ —Ç–µ –º—ñ—Å—Ü–µ, –¥–µ –≤–∏ –≤–∏–∑–Ω–∞—á–∞—î—Ç–µ –º–∞—Ä—à—Ä—É—Ç–∏ —Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ –≤–∞—à–æ–≥–æ API. –í–∏ [—Å—Ç–≤–æ—Ä—é—î—Ç–µ –æ–∫—Ä–µ–º—ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∏](https://trpc.io/docs/v10/router) –¥–ª—è –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä.

### üìÑ `server/api/root.ts`

–¢—É—Ç –º–∏ [–æ–±'—î–¥–Ω—É—î–º–æ](https://trpc.io/docs/v10/merging-routers) –≤—Å—ñ –ø—ñ–¥-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∏, –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –≤ `routers/**` –≤ —î–¥–∏–Ω–∏–π –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä.

### üìÑ `utils/api.ts`

–¶–µ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É –¥–ª—è tRPC –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ. –¢—É—Ç –≤–∏ —ñ–º–ø–æ—Ä—Ç—É—î—Ç–µ **–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤** –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ —Ç–∞ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –∫–ª—ñ—î–Ω—Ç tRPC —Ä–∞–∑–æ–º —ñ–∑ —Ö—É–∫–∞–º–∏ react-query. –û—Å–∫—ñ–ª—å–∫–∏ –º–∏ –≤–∫–ª—é—á–∏–ª–∏ `superjson` —è–∫ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—á –¥–∞–Ω–∏—Ö –Ω–∞ –±–µ–∫–µ–Ω–¥—ñ, –Ω–∞–º —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–ª—é—á–∏—Ç–∏ –π–æ–≥–æ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ. –¶–µ —Ç–æ–º—É —â–æ —Å–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ –∑ –±—ç–∫–µ–Ω–¥–∞ –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑—É—é—Ç—å—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ.

–¢—É—Ç –≤–∏ –≤–∏–∑–Ω–∞—á–∏—Ç–µ —Å–≤–æ—ó tRPC [–ø–æ—Å–∏–ª–∞–Ω–Ω—è](https://trpc.io/docs/v10/links), —è–∫—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –ø–æ—Ç—ñ–∫ –∑–∞–ø–∏—Ç—ñ–≤ –≤—ñ–¥ –∫–ª—ñ—î–Ω—Ç–∞ –¥–æ —Å–µ—Ä–≤–µ—Ä–∞. –ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ "default" [`httpBatchLink`](https://trpc.io/docs/v10/links/httpBatchLink), —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î [–≥—Ä—É–ø—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏](https://cloud.google.com/compute/docs/api/how-tos/batch), –∞ —Ç–∞–∫–æ–∂ [`loggerLink`](https://trpc.io/docs/v10/links/loggerLink), —â–æ –≤–∏–≤–æ–¥–∏—Ç—å –∫–æ—Ä–∏—Å–Ω—ñ –∂—É—Ä–Ω–∞–ª–∏ –∑–∞–ø–∏—Ç—ñ–≤ –ø—ñ–¥ —á–∞—Å —Ä–æ–∑—Ä–æ–±–∫–∏.

–ó—Ä–µ—à—Ç–æ—é, –º–∏ –µ–∫—Å–ø–æ—Ä—Ç—É—î–º–æ [–¥–æ–ø–æ–º—ñ–∂–Ω–∏–π —Ç–∏–ø](https://trpc.io/docs/v10/infer-types#additional-dx-helper-type), —è–∫–∏–π –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –≤–∏–≤–µ–¥–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ.

<div class="embed">
<iframe width="560" height="315" src="https://www.youtube.com/embed/x4mu-jOiA0Q" title="How tRPC really works" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

Create T3 App –∫–æ–Ω—Ç—Ä–∏–±‚Äô—é—Ç–æ—Ä [Christopher Ehrlich](https://twitter.com/ccccjjjjeeee) –∑—Ä–æ–±–∏–≤ [–≤—ñ–¥–µ–æ –ø—Ä–æ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–∏—Ö —É tRPC](https://www.youtube.com/watch?v=x4mu-jOiA0Q). –¶–µ –≤—ñ–¥–µ–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ tRPC, –∞–ª–µ –≤—Å–µ —â–µ –≤—ñ–¥—á—É–≤–∞—î—Ç–µ, —â–æ —Ç—Ä–æ—Ö–∏ –Ω–µ —Ä–æ–∑—É–º—ñ—î—Ç–µ —è–∫ –≤–æ–Ω–æ –ø—Ä–∞—Ü—é—î.

## –Ø–∫ —è –º–æ–∂—É –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Å–≤—ñ–π API –∑–∑–æ–≤–Ω—ñ?

–£ –∑–≤–∏—á–∞–π–Ω–∏—Ö API, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤–∞—à—ñ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏ (endpoints) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –±—É–¥—å-—è–∫–∏–π HTTP –∫–ª—ñ—î–Ω—Ç, —è–∫ `curl`, `Postman`, `fetch` –∞–±–æ –ø—Ä—è–º–æ –∑ –≤–∞—à–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞. –ó tRPC, —Ü–µ –ø—Ä–∞—Ü—é—î —Ç—Ä–æ—Ö–∏ —ñ–Ω–∞–∫—à–µ. –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤–∞—à—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ –±–µ–∑ –∫–ª—ñ—î–Ω—Ç–∞ tRPC, —î –¥–≤–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ:

### –†–æ–∑–∫—Ä–∏–π—Ç–µ –æ–¥–Ω—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∑–æ–≤–Ω—ñ

–Ø–∫—â–æ –≤–∏ –±–∞–∂–∞—î—Ç–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ –≤–∞—à—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∑–æ–≤–Ω—ñ, –≤–∞–º –≤–∞—Ä—Ç–æ —à—É–∫–∞—Ç–∏ [server side calls](https://trpc.io/docs/v10/server-side-calls). –¶–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –≤–∞–º —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–≤–∏—á–∞–π–Ω—É –∫—ñ–Ω—Ü–µ–≤—É —Ç–æ—á–∫—É (endpoint) API Next.js, –∞–ª–µ –ø–µ—Ä–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —á–∞—Å—Ç–∏–Ω—É —Ä–µ–∑–æ–ª–≤–µ—Ä–∞ –≤–∞—à–æ—ó –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ tRPC.

```ts:pages/api/users/[id].ts
import { type NextApiRequest, type NextApiResponse } from "next";
import { appRouter, createCaller } from "../../../server/api/root";
import { createTRPCContext } from "../../../server/api/trpc";

const userByIdHandler = async (req: NextApiRequest, res: NextApiResponse) => {
  // Create context and caller
  const ctx = await createTRPCContext({ req, res });
  const caller = createCaller(ctx);
  try {
    const { id } = req.query;
    const user = await caller.user.getById(id);
    res.status(200).json(user);
  } catch (cause) {
    if (cause instanceof TRPCError) {
      // An error from tRPC occurred
      const httpCode = getHTTPStatusCodeFromError(cause);
      return res.status(httpCode).json(cause);
    }
    // Another error occurred
    console.error(cause);
    res.status(500).json({ message: "Internal server error" });
  }
};

export default userByIdHandler;
```

### –†–æ–∑–∫—Ä–∏–π—Ç–µ –∫–æ–∂–Ω—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∑–æ–≤–Ω—ñ—à–Ω—å–æ

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ –±—É–¥—å-—è–∫—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –∑–∑–æ–≤–Ω—ñ, –ø–æ–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ –ø–ª–∞–≥—ñ–Ω–æ–º —Å–ø—ñ–ª—å–Ω–æ—Ç–∏ [trpc-openapi](https://github.com/jlalmes/trpc-openapi/tree/master). –ù–∞–¥–∞—é—á–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –º–µ—Ç–∞–¥–∞–Ω–Ω—ñ –≤–∞—à–∏–º –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º, –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π REST API –∑ –≤–∞—à–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ tRPC.

### –¶–µ –≤—Å—å–æ–≥–æ –ª–∏—à–µ HTTP-–∑–∞–ø–∏—Ç–∏

tRPC –≤–∑–∞—î–º–æ–¥—ñ—î —á–µ—Ä–µ–∑ HTTP, —Ç–æ–º—É —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤–∞—à—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ tRPC –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é "–∑–≤–∏—á–∞–π–Ω–∏—Ö" HTTP-–∑–∞–ø–∏—Ç—ñ–≤. –û–¥–Ω–∞–∫ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–ø—Ä–∏–π–Ω—è—Ç–Ω–∏–º —ñ–∑-–∑–∞ [–ø—Ä–æ—Ç–æ–∫–æ–ª—É RPC](https://trpc.io/docs/v10/rpc), —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î tRPC. –Ø–∫—â–æ –≤–∞–º —Ü—ñ–∫–∞–≤–æ, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —è–∫ –≤–∏–≥–ª—è–¥–∞—é—Ç—å –∑–∞–ø–∏—Ç–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ tRPC —É –≤–∞—à—ñ–π network –≤–∫–ª–∞–¥—Ü—ñ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä–∞, –∞–ª–µ –º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ —Ä–æ–±–∏—Ç–∏ —Ü–µ –ª–∏—à–µ –≤ —è–∫–æ—Å—Ç—ñ –Ω–∞–≤—á–∞–ª—å–Ω–æ—ó –≤–ø—Ä–∞–≤–∏ —ñ –ø—Ä–∏—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è –æ–¥–Ω–æ–≥–æ –∑ —Ä—ñ—à–µ–Ω—å, –æ–ø–∏—Å–∞–Ω–∏—Ö –≤–∏—â–µ.

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –∫—ñ–Ω—Ü–µ–≤–æ—é —Ç–æ—á–∫–æ—é (enpoint) Next.js API

–î–∞–≤–∞–π—Ç–µ –ø–æ—Ä—ñ–≤–Ω—è—î–º–æ –∫—ñ–Ω—Ü–µ–≤—É —Ç–æ—á–∫—É Next.js API –∑ –ø—Ä–æ—Ü–µ–¥—É—Ä–æ—é tRPC. –ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, –º–∏ —Ö–æ—á–µ–º–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–±'—î–∫—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –Ω–∞—à–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —ñ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –π–æ–≥–æ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥. –ú–∏ –º–æ–≥–ª–∏ –± –Ω–∞–ø–∏—Å–∞—Ç–∏ –∫—ñ–Ω—Ü–µ–≤—É —Ç–æ—á–∫—É Next.js API —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:

```ts:pages/api/users/[id].ts
import { type NextApiRequest, type NextApiResponse } from "next";
import { prisma } from "../../../server/db";

const userByIdHandler = async (req: NextApiRequest, res: NextApiResponse) => {
  if (req.method !== "GET") {
    return res.status(405).end();
  }

  const { id } = req.query;

  if (!id || typeof id !== "string") {
    return res.status(400).json({ error: "Invalid id" });
  }

  const examples = await prisma.example.findFirst({
    where: {
      id,
    },
  });

  res.status(200).json(examples);
};

export default userByIdHandler;
```

```ts:pages/users/[id].tsx
import { useState, useEffect } from "react";
import { useRouter } from "next/router";

const UserPage = () => {
  const router = useRouter();
  const { id } = router.query;

  const [user, setUser] = useState(null);
  useEffect(() => {
    fetch(`/api/user/${id}`)
      .then((res) => res.json())
      .then((data) => setUser(data));
  }, [id]);
};
```

–ü–æ—Ä—ñ–≤–Ω—è–π—Ç–µ —Ü–µ –∑ –ø—Ä–∏–∫–ª–∞–¥–æ–º tRPC –≤–∏—â–µ —ñ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –¥–µ—è–∫—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ tRPC:

- –ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –≤–∫–∞–∑—É–≤–∞—Ç–∏ URL –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É, —è–∫–∏–π –º–æ–∂–µ —Å—Ç–∞—Ç–∏ –Ω–µ–∑—Ä—É—á–Ω–∏–º –¥–ª—è –¥–µ–±–∞–≥—ñ–Ω–≥—É, —è–∫—â–æ –≤–∏ –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–µ —â–æ—Å—å, –≤–∞—à –≤–µ—Å—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä - —Ü–µ –æ–±'—î–∫—Ç –∑ –∞–≤—Ç–æ–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è–º.
- –í–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏, —è–∫–∏–π –º–µ—Ç–æ–¥ HTTP –±—É–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π.
- –í–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏, —â–æ –∑–∞–ø–∏—Ç –∞–±–æ —Ç—ñ–ª–æ –∑–∞–ø–∏—Ç—É –º—ñ—Å—Ç—è—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –¥–∞–Ω—ñ —É –ø—Ä–æ—Ü–µ–¥—É—Ä—ñ, —Ç–æ–º—É —â–æ Zod –ø–æ–¥–±–∞—î –ø—Ä–æ —Ü–µ.
- –ó–∞–º—ñ—Å—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–∏–¥–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∞–±–æ –æ–±'—î–∫—Ç, —è–∫ —É –±—É–¥—å-—è–∫—ñ–π —ñ–Ω—à—ñ–π —Ñ—É–Ω–∫—Ü—ñ—ó TypeScript.
- –í–∏–∫–ª–∏–∫–∞—é—á–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—É –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ, –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –∞–≤—Ç–æ–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ç–∏–ø—ñ–≤.

## –ö–æ—Ä–∏—Å–Ω—ñ —Å–Ω—ñ–ø–µ—Ç–∏

–¢—É—Ç –Ω–∞–≤–µ–¥–µ–Ω—ñ –¥–µ—è–∫—ñ —Å–Ω—ñ–ø–µ—Ç–∏, —è–∫—ñ –º–æ–∂—É—Ç—å —Å—Ç–∞—Ç–∏ –≤ –Ω–∞–≥–æ–¥—ñ.

### –í–∫–ª—é—á–µ–Ω–Ω—è CORS

–Ø–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–∞—à API –∑ —ñ–Ω—à–æ–≥–æ –¥–æ–º–µ–Ω—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –≤ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó, —è–∫–∏–π –≤–∫–ª—é—á–∞—î –¥–æ–¥–∞—Ç–æ–∫ React Native, –≤–∞–º –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –≤–∫–ª—é—á–∏—Ç–∏ CORS:

```ts:pages/api/trpc/[trpc].ts
import { type NextApiRequest, type NextApiResponse } from "next";
import { createNextApiHandler } from "@trpc/server/adapters/next";
import { appRouter } from "~/server/api/root";
import { createTRPCContext } from "~/server/api/trpc";
import cors from "nextjs-cors";

const handler = async (req: NextApiRequest, res: NextApiResponse) => {
  // Enable cors
  await cors(req, res);

  // Create and call the tRPC handler
  return createNextApiHandler({
    router: appRouter,
    createContext: createTRPCContext,
  })(req, res);
};

export default handler;
```

### –û–ø—Ç–∏–º—ñ—Å—Ç–∏—á–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–û–ø—Ç–∏–º—ñ—Å—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è - —Ü–µ –∫–æ–ª–∏ –º–∏ –æ–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ —Ç–æ–≥–æ, —è–∫ API-–∑–∞–ø–∏—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è. –¶–µ –Ω–∞–¥–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ –∫—Ä–∞—â–∏–π –¥–æ—Å–≤—ñ–¥, —Ç–æ–º—É —â–æ –≤—ñ–Ω –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω —á–µ–∫–∞—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è API-–∑–∞–ø–∏—Ç—É, –ø–µ—Ä—à –Ω—ñ–∂ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –π–æ–≥–æ –¥—ñ—ó. –û–¥–Ω–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ —Ü—ñ–Ω—É—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö, –ø–æ–≤–∏–Ω–Ω—ñ —É–Ω–∏–∫–∞—Ç–∏ –æ–ø—Ç–∏–º—ñ—Å—Ç–∏—á–Ω–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –Ω–µ —î ¬´–≤—ñ—Ä–Ω–∏–º¬ª —É—è–≤–ª–µ–Ω–Ω—è–º —Å—Ç–∞–Ω—É –±–µ–∫–µ–Ω–¥–∞. –í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –±—ñ–ª—å—à–µ —É [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó React Query](https://tanstack.com/query/v4/docs/guides/optimistic-updates).

```tsx
const MyComponent = () => {
  const listPostQuery = api.post.list.useQuery();

  const utils = api.useContext();
  const postCreate = api.post.create.useMutation({
    async onMutate(newPost) {
      // Cancel outgoing fetches (so they don't overwrite our optimistic update)
      await utils.post.list.cancel();

      // Get the data from the queryCache
      const prevData = utils.post.list.getData();

      // Optimistically update the data with our new post
      utils.post.list.setData(undefined, (old) => [...old, newPost]);

      // Return the previous data so we can revert if something goes wrong
      return { prevData };
    },
    onError(err, newPost, ctx) {
      // If the mutation fails, use the context-value from onMutate
      utils.post.list.setData(undefined, ctx.prevData);
    },
    onSettled() {
      // Sync with server once mutation has settled
      utils.post.list.invalidate();
    },
  });
};
```

### –ü—Ä–æ—Å—Ç–∏–π –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–∏–π –¢–µ—Å—Ç

–¢—É—Ç –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –ø—Ä–æ—Å—Ç–∏–π —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–∏–π —Ç–µ—Å—Ç, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [Vitest](https://vitest.dev), —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –≤–∞—à –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä tRPC –ø—Ä–∞—Ü—é—î –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º, –ø–∞—Ä—Å–µ—Ä –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –≤–∏–≤–æ–¥–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ç–∏–ø —ñ –¥–∞–Ω—ñ, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –æ—á—ñ–∫—É–≤–∞–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.

```ts
import { type inferProcedureInput } from "@trpc/server";
import { expect, test } from "vitest";

import { appRouter, type AppRouter } from "~/server/api/root";
import { createInnerTRPCContext } from "~/server/api/trpc";

test("example router", async () => {
  const ctx = await createInnerTRPCContext({ session: null });
  const caller = appRouter.createCaller(ctx);

  type Input = inferProcedureInput<AppRouter["example"]["hello"]>;
  const input: Input = {
    text: "test",
  };

  const example = await caller.example.hello(input);

  expect(example).toMatchObject({ greeting: "Hello test" });
});
```

–Ø–∫—à–æ –≤–∞—à–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –∑–∞—Ö–∏—â–µ–Ω–∞, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç–∏ –∑–∞–º–æ–∫–∞–Ω–∏–π –æ–±'—î–∫—Ç `session` –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:

```ts
test("protected example router", async () => {
  const ctx = await createInnerTRPCContext({
    session: {
      user: { id: "123", name: "John Doe" },
      expires: "1",
    },
  });
  const caller = appRouter.createCaller(ctx);

  // ...
});
```

## –ö–æ—Ä–∏—Å–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏

| –†–µ—Å—É—Ä—Å                               | –ü–æ—Å–∏–ª–∞–Ω–Ω—è                                               |
| ------------------------------------ | ------------------------------------------------------- |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è tRPC                    | https://www.trpc.io                                     |
| –î–µ–∫—ñ–ª—å–∫–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è tRPC | https://github.com/trpc/trpc/tree/next/examples         |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è React Query             | https://tanstack.com/query/v4/docs/adapters/react-query |
