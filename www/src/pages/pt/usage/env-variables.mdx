---
title: Vari√°veis de Ambiente
description: Iniciando com Create T3 App 
layout: ../../../layouts/docs.astro
lang: pt
isMdx: true
---

import Callout from "../../../components/docs/callout.tsx";

O Create T3 App usa sua mais nova biblioteca [@t3-oss/env-nextjs](https://env.t3.gg) e [zod](https://zod.dev) para validar vari√°veis de ambiente durante o tempo de execu√ß√£o (runtime) _e_ buildtime fornecendo uma l√≥gica simples no arquivo `src/env.mjs`:

## env.mjs

_Muito longo, n√£o li; Se voc√™ quiser adicionar uma nova vari√°vel de ambiente, voc√™ deve adicion√°-la ao seu `.env` ao definir no validador em `src/env.mjs`._

Este arquivo √© dividido em duas partes - o esquema e a desestrutura√ß√£o do objeto, bem como a l√≥gica de valida√ß√£o. A l√≥gica de valida√ß√£o n√£o deve ser tocada.

```ts:env.mjs
import { createEnv } from "@t3-oss/env-nextjs";
import { z } from "zod";
 
export const env = createEnv({
  server: {
    NODE_ENV: z.enum(["development", "test", "production"]),
  },
  client: {
    // NEXT_PUBLIC_CLIENTVAR: z.string(),
  },
  runtimeEnv: {
    NODE_ENV: process.env.NODE_ENV,
  },
});
```

T3 Env traz um novo conceito atrav√©s do `createEnv`, o qual √© respons√°vel por criar o esquema e ir√° incluir a l√≥gica de valida√ß√£o para  vari√°veis de ambiente no cliente e servidor. 

<Callout type="info">
    Para mais informa√ß√µes sobre como o `createEnv` funciona internamente, confira a documenta√ß√£o de [T3 Env](https://env.t3.gg/docs/introduction)
</Callout>

## Usando Vari√°veis de Ambiente

Quando voc√™ quiser usar suas vari√°veis de ambiente, voc√™ pode import√°-las de `env.mjs` e us√°-las como faria normalmente. Se voc√™ importar isso no cliente e tentar acessar uma vari√°vel de ambiente do lado do servidor, receber√° um erro em tempo de execu√ß√£o (runtime).

```ts:pages/api/hello.ts
import { env } from "../../env.mjs";

// `env` √© totalmente tipado e fornece preenchimento autom√°tico 
const dbUrl = env.DATABASE_URL;
```

```ts:pages/index.tsx
import { env } from "../env.mjs";

// ‚ùå Isso lan√ßar√° um erro em tempo de execu√ß√£o
const dbUrl = env.DATABASE_URL;

// ‚úÖ Isso est√° correto
const wsKey = env.NEXT_PUBLIC_WS_KEY;
```

## .env.example

Como o arquivo `.env` padr√£o n√£o est√° comprometido com o controle de vers√£o, tamb√©m inclu√≠mos um arquivo `.env.example`, no qual voc√™ pode, opcionalmente, manter uma c√≥pia de seu arquivo `.env` com quaisquer segredos removidos. Isso n√£o √© necess√°rio, mas recomendamos manter o exemplo atualizado para tornar mais f√°cil para os contribuidores come√ßarem a usar seu ambiente.

Alguns frameworks e outras ferramentas, como o Next.js, sugerem que voc√™ armazene vari√°veis em um arquivo `.env.local` e fa√ßa commit de arquivos `.env` em seu projeto. Isso n√£o √© recomendado, pois poderia facilitar o acidente de incluir vari√°veis ambiente secretas em seu hist√≥rico do git. Em vez disso, recomendamos que voc√™ armazene essas vari√°veis no arquivo `.env`, mantenha o arquivo `.env` em seu `.gitignore` e fa√ßa commit somente de arquivos `.env.example` em seu projeto.

## Adicionando Vari√°veis Ambiente

Para garantir que sua compila√ß√£o nunca seja conclu√≠da sem as vari√°veis de ambiente de que o projeto precisa, voc√™ precisar√° adicionar novas vari√°veis de ambiente em **dois** locais:

üìÑ `.env`: Insira sua vari√°vel de ambiente como faria normalmente em um arquivo `.env`, ou seja, `CHAVE=VALOR`. Al√©m disso, certifique-se de desestruturar elas na op√ß√£o `runtimeEnv`, por exemplo, `CHAVE: process.env.CHAVE`.

üìÑ `env.mjs`: Adicione a l√≥gica de valida√ß√£o apropriada para as vari√°veis de ambiente definindo um esquema Zod, por exemplo `NOME_DA_VARIAVEL: z.string()`

Opcionalmente, voc√™ tamb√©m pode manter `.env.example` atualizado:

üìÑ `.env.example`: Insira sua vari√°vel de ambiente, mas certifique-se de n√£o incluir o valor se for secreto, ou seja, `CHAVE=VALOR` ou `CHAVE=`

### Exemplo

_Quero adicionar meu token da API do Twitter como uma vari√°vel de ambiente do lado do servidor_

1. Adicione a vari√°vel de ambiente a `.env`:

```
TWITTER_API_TOKEN=1234567890
```

2. Adicione a vari√°vel de ambiente a `env.mjs`:

```ts
import { createEnv } from "@t3-oss/env-nextjs";
import { z } from "zod";
 
export const env = createEnv({
  server: {
    TWITTER_API_TOKEN: z.string(),
  },
  // ...
});
```

<Callout type="info">
  Uma string vazia ainda √© uma string, ent√£o `z.string()` aceitar√° uma string
  vazia como um valor v√°lido. Se voc√™ quiser ter certeza de que a vari√°vel de
  ambiente n√£o est√° vazia, voc√™ pode usar `z.string().min(1)`.
</Callout>

3. opcional: adicione a vari√°vel de ambiente a `.env.example`, mas n√£o inclua o token

```
export const env = createEnv({
  // ...
  runtimeEnv: {
    TWITTER_API_TOKEN: process.env.TWITTER_API_TOKEN,
  },
});
```
